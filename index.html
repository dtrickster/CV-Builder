<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>CV Builder</title>
<style>
body {
    font-family: Arial, sans-serif;
    margin: 0;
    padding: 20px;
    background-color: #e0f7fa;
}
h1 {
    text-align: center;
    color: #00796b;
    margin-top: 100px; /* Increased space from top */
}
form {
    background: white;
    padding: 20px;
    border-radius: 5px;
    box-shadow: 0 0 10px rgba(0, 0, 0, 0.1);
    max-width: 600px;
    margin: auto;
}
input, textarea {
    width: 100%;
    padding: 10px;
    margin: 10px 0;
    border: 1px solid #ccc;
    border-radius: 5px;
}
button {
    background-color: #00796b;
    color: white;
    border: none;
    padding: 10px;
    border-radius: 5px;
    cursor: pointer;
    width: 100%;
}
button:hover {
    background-color: #004d40;
}
</style>
</head>
<body>
<h1>CV Builder</h1>
<form id="cvForm">
<h2>Personal Information</h2>
<input type="text" id="name" placeholder="Full Name" required>
<input type="text" id="email" placeholder="Email" required>
<input type="text" id="phone" placeholder="Phone Number" required>
<input type="text" id="linkedin" placeholder="LinkedIn Account">
<h2>Personal Data</h2>
<input type="text" id="gender" placeholder="Gender">
<input type="text" id="age" placeholder="Age">
<input type="text" id="nationality" placeholder="Nationality">
<input type="text" id="address" placeholder="Home Address">
<h2>Education</h2>
<textarea id="education" placeholder="Education" required></textarea>
<h2>Work Experience</h2>
<textarea id="workExperience" placeholder="Work Experience" required></textarea>
<h2>Additional Experience</h2>
<textarea id="additionalExperience" placeholder="Additional Experience"></textarea>
<h2>Skills and Interests</h2>
<textarea id="skillsInterests" placeholder="Skills and Interests"></textarea>
<button type="submit">Generate CV</button>
</form>
<script>
document.getElementById('cvForm').addEventListener('submit', function(e) {
    e.preventDefault();

    const cvData = {
        name: document.getElementById('name').value,
        email: document.getElementById('email').value,
        phone: document.getElementById('phone').value,
        linkedin: document.getElementById('linkedin').value,
        gender: document.getElementById('gender').value,
        age: document.getElementById('age').value,
        nationality: document.getElementById('nationality').value,
        address: document.getElementById('address').value,
        education: document.getElementById('education').value,
        workExperience: document.getElementById('workExperience').value,
        additionalExperience: document.getElementById('additionalExperience').value,
        skillsInterests: document.getElementById('skillsInterests').value
    };

    const cvContent = `
    <html>
    <head>
        <meta charset="UTF-8">
        <style>
            body { font-family: 'Calibri', sans-serif; }
            h1 { color: #00796b; text-align: center; margin-top: 100px; }
            h2 { color: #004d40; border-bottom: 1px solid black; padding-bottom: 5px; }
            .contact-info { text-align: center; font-size: 12px; color: #555; margin-bottom: 20px; }
            ul { margin: 0 0 10px 20px; }
            li { margin-bottom: 5px; }
            .section { margin-bottom: 20px; }
            .education ul, .education li { font-weight: bold; }
            .personal-data h2 { font-weight: bold; } /* Bold subheading */
        </style>
    </head>
    <body>
        <h1>${cvData.name}</h1>
        <div class="contact-info">
            <p>${cvData.email} | ${cvData.phone} | LinkedIn: ${cvData.linkedin}</p> <!-- Added "LinkedIn:" -->
        </div>
        <div class="section personal-data">
            <h2>Personal Data</h2>
            <ul>
                <li>Gender: ${cvData.gender}</li>
                <li>Age: ${cvData.age}</li>
                <li>Nationality: ${cvData.nationality}</li>
                <li>Address: ${cvData.address}</li>
            </ul>
        </div>
        <div class="section education">
            <h2>Education</h2>
            <ul>
                <li>${cvData.education.replace(/\n/g, '</li><li>')}</li>
            </ul>
        </div>
        <div class="section">
            <h2>Work Experience</h2>
            <ul>
                <li>${cvData.workExperience.replace(/\n/g, '</li><li>')}</li>
            </ul>
        </div>
        <div class="section">
            <h2>Additional Experience</h2>
            <ul>
                <li>${cvData.additionalExperience.replace(/\n/g, '</li><li>')}</li>
            </ul>
        </div>
        <div class="section">
            <h2>Skills and Interests</h2>
            <ul>
                <li>${cvData.skillsInterests.replace(/\n/g, '</li><li>')}</li>
            </ul>
        </div>
    </body>
    </html>
    `;

    const blob = new Blob(['\ufeff', cvContent], { type: 'application/msword' });
    const url = URL.createObjectURL(blob);
    const a = document.createElement('a');
    a.href = url;
    a.download = 'CV.doc';
    document.body.appendChild(a);
    a.click();
    document.body.removeChild(a);
    URL.revokeObjectURL(url);
});

window.onload = function() {
    const savedData = JSON.parse(localStorage.getItem('cvData'));
    if (savedData) {
        document.getElementById('name').value = savedData.name || '';
        document.getElementById('email').value = savedData.email || '';
        document.getElementById('phone').value = savedData.phone || '';
        document.getElementById('linkedin').value = savedData.linkedin || '';
        document.getElementById('gender').value = savedData.gender || '';
        document.getElementById('age').value = savedData.age || '';
        document.getElementById('nationality').value = savedData.nationality || '';
        document.getElementById('address').value = savedData.address || '';
        document.getElementById('education').value = savedData.education || '';
        document.getElementById('workExperience').value = savedData.workExperience || '';
        document.getElementById('additionalExperience').value = savedData.additionalExperience || '';
        document.getElementById('skillsInterests').value = savedData.skillsInterests || '';
    }
};
</script>
<div class="message">
    <p><strong>Dear users,</strong></p>
    <p>I hope you enjoy our product!</p>
    <p>Please be sure to save your data as soon as you are completed as we are still in the testing phase. Note that the output CV is optimized for website design and may not work on some browsers. Feel free to edit the sections in the curriculum vitae as you see fit, including emboldening text and inserting photos.</p>
    <p>The output is in British CV formatting, which you can learn more about from the <a href="https://www.careers.ox.ac.uk/cvs#collapse1542131" target="_blank">Oxford Careers Service</a>.</p>
    <p><strong>Happy Applying!</strong></p>
</div>
</body>
</html>
